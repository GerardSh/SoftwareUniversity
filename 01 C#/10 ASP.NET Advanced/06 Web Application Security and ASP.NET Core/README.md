# General
## Common Web App Security Problems
**XSS, SQL Injection, CSRF, Parameter Tampering**

SQL –∏–Ω–∂–µ–∫—Ü–∏—è.

Cross-site Scripting (XSS).

–ú–∞–Ω–∏–ø—É–ª–∞—Ü–∏–∏ –Ω–∞ URL / HTTP –∑–∞—è–≤–∫–∏ (Parameter Tampering).

Cross-site Request Forgery (CSRF).

DoS, DDoS –∏ Brute Force –∞—Ç–∞–∫–∏. DoS –∏ DDoS –∞—Ç–∞–∫–∏—Ç–µ –æ–±–∏–∫–Ω–æ–≤–µ–Ω–æ **–Ω–µ —Å–∞ –Ω–∞ –ø—Ä–∏–ª–æ–∂–Ω–æ –Ω–∏–≤–æ**, –∞ –¥–µ–π—Å—Ç–≤–∞—Ç –Ω–∞ **–º—Ä–µ–∂–æ–≤–æ –∏–ª–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ –Ω–∏–≤–æ** (–Ω–∞–ø—Ä. Layer 3/4 –æ—Ç OSI –º–æ–¥–µ–ª–∞). –¢–µ —Ü–µ–ª—è—Ç –¥–∞ –ø—Ä–µ—Ç–æ–≤–∞—Ä—è—Ç —Å—ä—Ä–≤—ä—Ä–∞, –º—Ä–µ–∂–æ–≤–∞—Ç–∞ –≤—Ä—ä–∑–∫–∞ –∏–ª–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞ —á—Ä–µ–∑ –≥–æ–ª—è–º –±—Ä–æ–π –∑–∞—è–≤–∫–∏, —á–µ—Å—Ç–æ –±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ –∏–º. Brute Force –∞—Ç–∞–∫–∏—Ç–µ, –æ—Ç –¥—Ä—É–≥–∞ —Å—Ç—Ä–∞–Ω–∞, **—Å–µ –∏–∑–≤—ä—Ä—à–≤–∞—Ç –Ω–∞ –ø—Ä–∏–ª–æ–∂–Ω–æ –Ω–∏–≤–æ** (Layer 7), –∑–∞—â–æ—Ç–æ –≤–∫–ª—é—á–≤–∞—Ç –æ–ø–∏—Ç–∏ –∑–∞ –¥–æ—Å—Ç—ä–ø —á—Ä–µ–∑ –ª–æ–≥–∏—á–µ—Å–∫–∏ –∑–∞—è–≤–∫–∏ –∫—ä–º —Å–∞–º–æ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–∏ –æ–ø–∏—Ç–∏ –∑–∞ –≤—Ö–æ–¥ —Å —Ä–∞–∑–ª–∏—á–Ω–∏ –ø–∞—Ä–æ–ª–∏).

–ü—Ä–µ–∫–∞–ª–µ–Ω–æ –º–Ω–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —Å—ä–æ–±—â–µ–Ω–∏—è—Ç–∞ –∑–∞ –≥—Ä–µ—à–∫–∏.

–ü—Ä–æ–±–ª–µ–º–∏ —Å—ä—Å —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –≤ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏—è —Å–æ—Ñ—Ç—É–µ—Ä –∏ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–∏—Ç–µ NuGet –ø–∞–∫–µ—Ç–∏.

–ù–∞–π-—á–µ—Å—Ç–æ —Å—Ä–µ—â–∞–Ω–∏ –ø—Ä–æ–±–ª–µ–º–∏ —Å—ä—Å —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –≤ —É–µ–± –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ç–∞.

[OWASP Top Ten | OWASP Foundation](https://owasp.org/www-project-top-ten/)

[Exploit Database - Exploits for Penetration Testers, Researchers, and Ethical Hackers](https://www.exploit-db.com/)

[DotNet Security - OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/cheatsheets/DotNet_Security_Cheat_Sheet.html)
## Other Security Threats
–°–µ–º–∞–Ω—Ç–∏—á–Ω–∏ –∞—Ç–∞–∫–∏ —á—Ä–µ–∑ URL/HTTP –º–∞–Ω–∏–ø—É–ª–∞—Ü–∏–∏. –î–∞–Ω–Ω–∏—Ç–µ –≤–∏–Ω–∞–≥–∏ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –≤–∞–ª–∏–¥–∏—Ä–∞—Ç –æ—Ç —Å—ä—Ä–≤—ä—Ä —Å—Ç—Ä–∞–Ω–∞.

Man in the Middle –∞—Ç–∞–∫–∏. –ü—Ä–µ–ø–æ—Ä—ä—á–≤–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ SSL –≤—ä–≤ –≤—Å–∏—á–∫–∏ —Å–ª—É—á–∞–∏.

–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª –Ω–∞ –¥–æ—Å—Ç—ä–ø–∞.

–†–∞–∑–ª–∏—á–Ω–∏ —Ñ–æ—Ä–º–∏ –Ω–∞ –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –µ –¥–∞–Ω–Ω–∏—Ç–µ –¥–∞ —Å–µ –ø—Ä–µ—á–∏—Å—Ç–≤–∞—Ç –ø—Ä–µ–¥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞.

Phishing –∏ —Å–æ—Ü–∏–∞–ª–Ω–æ –∏–Ω–∂–µ–Ω–µ—Ä—Å—Ç–≤–æ. –î–æ–±—Ä–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ –µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ –¥–∞ –±—ä–¥–∞—Ç –æ–±—É—á–µ–Ω–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–∞–Ω–∏.

–ü—Ä–æ–±–ª–µ–º–∏ —Å—ä—Å —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –≤ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–∏—è —Å–æ—Ñ—Ç—É–µ—Ä. –ü—Ä–µ–ø–æ—Ä—ä—á–≤–∞ —Å–µ —Ä–∞–±–æ—Ç–∞ —Å –Ω–∞–π-–Ω–æ–≤–∏—Ç–µ –Ω–∞–ª–∏—á–Ω–∏ –≤–µ—Ä—Å–∏–∏.
## Security Fundamentals
–°—ä—â–µ—Å—Ç–≤—É–≤–∞ —à–∏—Ä–æ–∫ –Ω–∞–±–æ—Ä –æ—Ç –¥–æ–±—Ä–µ –ø–æ–∑–Ω–∞—Ç–∏ —Ç–∏–ø–æ–≤–µ –∑–∞–ø–ª–∞—Ö–∏ –∏ –∞—Ç–∞–∫–∏.

| Category              | Category Threats / Attacks                                                                                         |
| --------------------- | ------------------------------------------------------------------------------------------------------------------ |
| Input Validation      | Buffer overflow, cross-site scripting, SQL injection, canonicalization                                             |
| Parameter Tampering   | Query string manipulation, form field manipulation, cookie manipulation, HTTP header manipulation                  |
| Session Management    | Session hijacking, session replay, man-in-the-middle                                                               |
| Cryptography          | Poor key generation or key management, weak or custom encryption                                                   |
| Sensitive Information | Access sensitive code or data in storage, network eavesdropping, code/data tampering, Admin password in exceptions |
| Exception Management  | Information disclosure, denial of service                                                                          |

–°—ä—â–µ—Å—Ç–≤—É–≤–∞ –æ—â–µ –ø–æ-—à–∏—Ä–æ–∫ –Ω–∞–±–æ—Ä –æ—Ç –Ω–µ–ø–æ–∑–Ω–∞—Ç–∏ –∑–∞–ø–ª–∞—Ö–∏ –∏ –∞—Ç–∞–∫–∏.
## Cross Site Scripting (XSS)
**Injecting Unsafe HTML Code (with Scripts)**

XSS –∞—Ç–∞–∫–∏—Ç–µ –ø–æ–∑–≤–æ–ª—è–≤–∞—Ç –Ω–∞ –∞—Ç–∞–∫—É–≤–∞—â–∏ –¥–∞ –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤–µ –≤ —É–µ–± —Å—Ç—Ä–∞–Ω–∏—Ü–∏, –∫–æ–∏—Ç–æ —Å–µ —Ä–∞–∑–≥–ª–µ–∂–¥–∞—Ç –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ.

–ü—Ä–∏–º–µ—Ä–Ω–æ: 

Client 1 –ø—É–±–ª–∏–∫—É–≤–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä, –∫–æ–π—Ç–æ —Å—ä–¥—ä—Ä–∂–∞ —Å–∫—Ä–∏–ø—Ç. –ú–∞–∫–∞—Ä —Å–∫—Ä–∏–ø—Ç—ä—Ç –¥–∞ –Ω–µ —Å–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞ –≤–µ–¥–Ω–∞–≥–∞, —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ –Ω–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä–∞ —Å–µ –∑–∞–ø–∏—Å–≤–∞ –≤ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏.

–ü–æ-–∫—ä—Å–Ω–æ, –∫–æ–≥–∞—Ç–æ –¥—Ä—É–≥ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª (–Ω–∞–ø—Ä. Client 2) –æ—Ç–≤–æ—Ä–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞ —Å –∫–æ–º–µ–Ω—Ç–∞—Ä–∏—Ç–µ, —Å—ä—Ä–≤—ä—Ä—ä—Ç –≤—Ä—ä—â–∞ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ –æ—Ç –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏ –±–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–ª–∏ –ø—Ä–µ—á–∏—Å—Ç–≤–∞–Ω–µ.

–í —Ä–µ–∑—É–ª—Ç–∞—Ç, —Å–∫—Ä–∏–ø—Ç—ä—Ç —Å–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞ –≤ –±—Ä–∞—É–∑—ä—Ä–∞ –Ω–∞ Client 2 —Å –Ω–µ–≥–æ–≤–∏—Ç–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –ø—Ä–∞–≤–∞ –∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Å–∞–π—Ç–∞.
### Demo
–ò–º–∞–º–µ —É—è–∑–≤–∏–º–æ ASP.NET Core —á–∞—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –¥–æ–±–∞–≤—è

```html
<script>
alert('Hacked!')
</script>
```

–°–ª–µ–¥ —Ç–æ–≤–∞ —Å–µ –ø–æ—è–≤—è–≤–∞ JavaScript –∏–∑—Å–∫–∞—á–∞—â –ø—Ä–æ–∑–æ—Ä–µ—Ü.

**With Image**

–ò–º–∞–º–µ —É—è–∑–≤–∏–º–æ JavaScript –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –¥–æ–±–∞–≤—è –Ω–µ–≤–∞–ª–∏–¥–µ–Ω URL –∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤—è `onclick` —Å—ä–±–∏—Ç–∏–µ —Å JavaScript —Å–∫—Ä–∏–ø—Ç.

–°–ª–µ–¥ —Ç–æ–≤–∞ —Å–µ –ø–æ—è–≤—è–≤–∞ JavaScript –∏–∑—Å–∫–∞—á–∞—â –ø—Ä–æ–∑–æ—Ä–µ—Ü.
### Why is XSS a Big Security Problem
–ê—Ç–∞–∫—É–≤–∞—â–∏—Ç–µ –º–æ–≥–∞—Ç:

–î–∞ –æ—Ç–∫—Ä–∞–¥–Ω–∞—Ç –±–∏—Å–∫–≤–∏—Ç–∫–∏, session storage, local storage –∏ –¥—Ä—É–≥–∏.

–î–∞ —Å–µ –ø—Ä–µ–¥—Å—Ç–∞–≤—è—Ç –∫–∞—Ç–æ –¥–∞–¥–µ–Ω –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä —á—Ä–µ–∑ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –Ω–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏ –∞–∫–∞—É–Ω—Ç.

–î–∞ –∏–∑–≤—ä—Ä—à–≤–∞—Ç –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç –∏–º–µ—Ç–æ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è.

–î–∞ –ø–æ–ª—É—á–∞—Ç –¥–æ—Å—Ç—ä–ø –¥–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–Ω–∏ –¥–∞–Ω–Ω–∏ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è.

–ò –¥—Ä—É–≥–∏.

**–ü—Ä–∏–º–µ—Ä:**

–ù—è–∫–æ–π –æ—Ç–∫—Ä–∏–≤–∞ —É—è–∑–≤–∏–º–æ—Å—Ç –≤ —É–µ–±—Å–∞–π—Ç, –∫–æ—è—Ç–æ –ø–æ–∑–≤–æ–ª—è–≤–∞ –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤–µ. 

–í—ä–∑–ø–æ–ª–∑–≤–∞ —Å–µ –æ—Ç –Ω–µ—è –∏ –¥–æ–±–∞–≤—è –∑–ª–æ–≤—Ä–µ–¥–µ–Ω —Å–∫—Ä–∏–ø—Ç.

–°–∫—Ä–∏–ø—Ç—ä—Ç —Å–µ –∑–∞–¥–µ–π—Å—Ç–≤–∞ –≤—Å–µ–∫–∏ –ø—ä—Ç, –∫–æ–≥–∞—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –ø–æ—Å–µ—Ç–∏ —Å–∞–π—Ç–∞. 

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∫–∞—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ, –ø–∞—Ä–æ–ª–∞, –±–∏—Å–∫–≤–∏—Ç–∫–∏ –∏ –¥—Ä—É–≥–∏ –¥–∞–Ω–Ω–∏ —Å–µ –∏–∑–ø—Ä–∞—â–∞—Ç –∫—ä–º –∞—Ç–∞–∫—É–≤–∞—â–∏—è.

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–µ–Ω –∫–æ–¥ –∏–º–∞ –≤ –¥–µ–º–æ –ø–∞–ø–∫–∞—Ç–∞.
### Protective measures
Razor –∏–∑–≥–ª–µ–¥–∏—Ç–µ –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ –æ—Å–∏–≥—É—Ä—è–≤–∞—Ç –∑–∞—â–∏—Ç–∞ —Å—Ä–µ—â—É XSS –∞—Ç–∞–∫–∏.

–ê–∫–æ —Ç–∞–∑–∏ –∑–∞—â–∏—Ç–∞ –±—ä–¥–µ –∑–∞–æ–±–∏–∫–æ–ª–µ–Ω–∞ ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä —á—Ä–µ–∑ `@Html.Raw(‚Ä¶)` ‚Äì –æ—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç—Ç–∞ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –ø—Ä–µ–º–∏–Ω–∞–≤–∞ –∫—ä–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.

–°—ä—â–µ—Å—Ç–≤—É–≤–∞—Ç –Ω—è–∫–æ–ª–∫–æ –≤–∞–∂–Ω–∏ –ø—Ä–∞–≤–∏–ª–∞, –∫–æ–∏—Ç–æ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ —Å–ø–∞–∑–≤–∞—Ç, –∑–∞ –¥–∞ —Å–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç:

–ù–∏–∫–æ–≥–∞ –Ω–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –ø–æ—Å—Ç–∞–≤—è –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ HTML –∏–∑—Ö–æ–¥–∞.

–ü—Ä–µ–¥–∏ –¥–∞ —Å–µ –≤–∫–ª—é—á–∞—Ç –Ω–µ–¥–æ–≤–µ—Ä–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –Ω—è–∫—ä–¥–µ, —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞ —Ç—è—Ö–Ω–∞—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç.

–¢–æ–≤–∞ –≤–∫–ª—é—á–≤–∞ –∫–æ–¥–∏—Ä–∞–Ω–µ, –ø–∞—Ä—Å–≤–∞–Ω–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –∑–ª–æ–≤—Ä–µ–¥–Ω–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ.

–ù–µ–¥–æ–≤–µ—Ä–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –º–æ–≥–∞—Ç –¥–∞ —Å–µ –æ–∫–∞–∂–∞—Ç –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ –º–µ—Å—Ç–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ:

URL –∞–¥—Ä–µ—Å–∏, HTML –µ–ª–µ–º–µ–Ω—Ç–∏, HTML –∞—Ç—Ä–∏–±—É—Ç–∏, JavaScript –∫–æ–¥ –∏ –¥—Ä—É–≥–∏.

ASP.NET Core –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è –≤—Å–∏—á–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∏ –∑–∞ –∑–∞—â–∏—Ç–∞ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ.

Razor –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–¥–∏—Ä–∞ —Ü–µ–ª–∏—è –∏–∑—Ö–æ–¥, –∫–æ–π—Ç–æ –∏–¥–≤–∞ –æ—Ç –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏.

–í—ä–∑–º–æ–∂–Ω–æ –µ –¥–∏—Ä–µ–∫—Ç–Ω–æ –¥–∞ —Å–µ –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞—Ç –µ–Ω–∫–æ–¥–µ—Ä–∏ –≤ –∏–∑–≥–ª–µ–¥–∏—Ç–µ –∏ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –ø—Ä–∏ –Ω—É–∂–¥–∞.

```csharp
@{ var untrustedInput = "<\"script\">"; }
@untrustedInput
// Output: &lt;&quot;script&quot;&gt;

@using System.Text.Encodings.Web;
@inject JavaScriptEncoder encoder;
@{ var untrustedInput = "<\"123\">"; }
<script> document.write("@encoder.Encode(untrustedInput)"); </script>
// Output: <script> document.write("\u003C\u0022123\u0022\u003E"); </script>
```

–ú–æ–≥–∞—Ç –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –∏ Encoder —É—Å–ª—É–≥–∏—Ç–µ, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–µ–Ω–∏ –æ—Ç ASP.NET Core:

`HtmlEncoder`  
`JavaScriptEncoder`  
`UrlEncoder`

–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, –º–æ–≥–∞—Ç –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –∏ —Å—Ç–∞—Ç–∏—á–Ω–∏—Ç–µ –º–µ—Ç–æ–¥–∏:

`WebUtility.HtmlEncode` –∏ `WebUtility.HtmlDecode`
`WebUtility.UrlEncode` –∏ `WebUtility.UrlDecode`

```csharp
<"123">        // original  
&#x3C;&#x22;123&#x22;&#x3E;  // HTML encoding  
\u003C\u0022123\u0022\u003E  // JavaScript encoding  
%3C%22123%22%3E  // URL encoding  
```
### `HtmlSanitizer`
`HtmlSanitizer` –µ .NET –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–∞ –ø—Ä–µ—á–∏—Å—Ç–≤–∞–Ω–µ –Ω–∞ HTML —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏ –æ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ–∏—Ç–æ –º–æ–≥–∞—Ç –¥–∞ –¥–æ–≤–µ–¥–∞—Ç –¥–æ XSS –∞—Ç–∞–∫–∏.

[mganss/HtmlSanitizer: Cleans HTML to avoid XSS attacks](https://github.com/mganss/HtmlSanitizer)

–¢—Ä—è–±–≤–∞ –¥–∞ —Å–µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞ NuGet –ø–∞–∫–µ—Ç–∞ `HtmlSanitizer`, —Å–ª–µ–¥ –∫–æ–µ—Ç–æ –º–æ–∂–µ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –ø–æ —Å–ª–µ–¥–Ω–∏—è –Ω–∞—á–∏–Ω:

```csharp
var sanitizer = new HtmlSanitizer();

var html = @"<script>alert('xss')</script><div onload=""alert('xss')"""
 + @"style=""background-color: test"">Test<img src=""test.gif"""
 + @"style=""background-image: url(javascript:alert('xss')); margin: 10px""></div>";

var sanitized = sanitizer.Sanitize(html, "http://www.example.com");

// The expected output after sanitizing
Assert.That(sanitized, Is.EqualTo(@"<div style=""background-color: test"">"
 + @"Test<img style=""margin: 10px"" src=""http://www.example.com/test.gif""></div>"));
```
## SQL Injection
**Inject SQL Code in Unsafe Database Query**
–°–ª–µ–¥–Ω–∏—Ç–µ SQL –∫–æ–º–∞–Ω–¥–∏ —Å–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞—Ç:

–û–±–∏—á–∞–π–Ω–æ —Ç—ä—Ä—Å–µ–Ω–µ (–±–µ–∑ SQL –∏–Ω–∂–µ–∫—Ü–∏—è):

```sql
SELECT * FROM Messages WHERE MessageText LIKE '%JohnSnow%'
```

SQL –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞–Ω–æ —Ç—ä—Ä—Å–µ–Ω–µ (–≤—Ä—ä—â–∞ –≤—Å–∏—á–∫–∏ –∑–∞–ø–∏—Å–∏):

```sql
SELECT * FROM Messages WHERE MessageText LIKE '%%%%'
```

SQL –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞–Ω–µ —Å INSERT –∫–æ–º–∞–Ω–¥–∞:

```sql
SELECT * FROM Messages WHERE MessageText LIKE '%'; 
INSERT INTO Messages(MessageText, MessageDate) VALUES
('Hacked!!!', '1.1.1980') --%'
```

SQL –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞–Ω–æ —Ç—ä—Ä—Å–µ–Ω–µ —Å —É—Å–ª–æ–≤–∏–µ, –∫–æ–µ—Ç–æ –≤–∏–Ω–∞–≥–∏ –µ –≤—è—Ä–Ω–æ:

```sql
SELECT * FROM Messages WHERE MessageText LIKE '%' or 1=1 --%'
```

–û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∞—Ç–∞ SQL –∑–∞—è–≤–∫–∞:

```sql
String sqlQuery = "SELECT * FROM user WHERE name = '" + username + "' AND pass='" + password + "'";
```

–ê–∫–æ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ `username` –µ –∑–∞–¥–∞–¥–µ–Ω–∞ –Ω–∞ `Admin`, –∞ `password` –Ω–∞ `' OR '1'='1`, —Ç–æ —Ä–µ–∑—É–ª—Ç–∞—Ç–Ω–∞—Ç–∞ –∑–∞—è–≤–∫–∞ —â–µ –∏–∑–≥–ª–µ–∂–¥–∞ —Ç–∞–∫–∞:

```sql
SELECT * FROM user WHERE name = 'Admin' AND pass='' OR '1'='1'
```

–†–µ–∑—É–ª—Ç–∞—Ç:

–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª —Å –∏–º–µ **Admin** —â–µ –≤–ª–µ–∑–µ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ **–±–µ–∑ –≤–∞–ª–∏–¥–Ω–∞ –ø–∞—Ä–æ–ª–∞**.

–ü—Ä–∏—á–∏–Ω–∞:

–£—Å–ª–æ–≤–∏–µ—Ç–æ `OR '1'='1'` **–≤–∏–Ω–∞–≥–∏ –µ –≤—è—Ä–Ω–æ**, —Ç–∞–∫–∞ —á–µ —Ç–æ –æ–±–µ–∑—Å–º–∏—Å–ª—è –≤—Å—è–∫–∞–∫–≤–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–∞—Ä–æ–ª–∞—Ç–∞. –¢–æ–≤–∞ –µ –∫–ª–∞—Å–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ—Ä –∑–∞ **SQL –∏–Ω–∂–µ–∫—Ü–∏—è**, –∫–æ—è—Ç–æ –º–æ–∂–µ –¥–∞ –∑–∞–æ–±–∏–∫–æ–ª–∏ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è—Ç–∞.
### Demo
**Normal Workflow:**

–ò–º–∞–º–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ñ–æ—Ä–º–∞ –∑–∞ –≤—Ö–æ–¥, –ø–æ–¥–∞—Ç–ª–∏–≤–∞ –Ω–∞ SQL –∏–Ω–∂–µ–∫—Ü–∏—è.

–ú–æ–∂–µ –¥–∞ –≤–ª–µ–∑–µ–º —Å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ **"Admin"** –∏ –ø–∞—Ä–æ–ª–∞ **"`adminpass`"** ‚Äì –ø–æ—è–≤—è–≤–∞ —Å–µ —Å—ä–æ–±—â–µ–Ω–∏–µ –∑–∞ —É—Å–ø–µ—à–µ–Ω –≤—Ö–æ–¥.

–í—Å–∏—á–∫–∏ –¥—Ä—É–≥–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ –∏ –ø–∞—Ä–æ–ª–∞ –≤–æ–¥—è—Ç –¥–æ —Å—ä–æ–±—â–µ–Ω–∏–µ –∑–∞ –≥—Ä–µ—à–∫–∞.

**Attack Workflow:**

–°–µ–≥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ **SQL –∏–Ω–∂–µ–∫—Ü–∏—è**, –∑–∞ –¥–∞ –≤–ª–µ–∑–µ–º —Å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª "Admin", –±–µ–∑ –¥–∞ –∑–Ω–∞–µ–º –ø–∞—Ä–æ–ª–∞—Ç–∞.

–í –ø–æ–ª–µ—Ç–æ –∑–∞ –ø–∞—Ä–æ–ª–∞ –≤—ä–≤–µ–∂–¥–∞–º–µ: `' OR '1'='1`

–¢–æ–≤–∞ –ø–æ–∑–≤–æ–ª—è–≤–∞ —É—Å–ø–µ—à–µ–Ω –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –±–µ–∑ –Ω—É–∂–¥–∞ –æ—Ç –≤–∞–ª–∏–¥–Ω–∞ –ø–∞—Ä–æ–ª–∞.

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–µ–Ω –∫–æ–¥ –∏–º–∞ –≤ –¥–µ–º–æ –ø–∞–ø–∫–∞—Ç–∞.
### Protective measures
–ù–µ —Å–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–∞ SQL —Å "+".

–ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞–Ω SQL –∏–ª–∏ —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏.

Escape-–≤–∞—Ç —Å–µ –∏ —Å–µ –ø–æ—á–∏—Å—Ç–≤–∞—Ç –≤—Å–∏—á–∫–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –≤—Ö–æ–¥–Ω–∏ –¥–∞–Ω–Ω–∏.

–ù–∏–∫–æ–≥–∞ –Ω–µ —Å–µ —Å–≤—ä—Ä–∑–≤–∞–º–µ —Å –±–∞–∑–∞ –¥–∞–Ω–Ω–∏ —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏ –∞–∫–∞—É–Ω—Ç.

–ù–µ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç —Ç–∞–π–Ω–∏ –≤ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –≤–∏–¥.

–ò–∑–∫–ª—é—á–µ–Ω–∏—è—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ —Ä–∞–∑–∫—Ä–∏–≤–∞—Ç –º–∏–Ω–∏–º–∞–ª–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

**Sample Code**

–£—è–∑–≤–∏–º –∫—ä–º SQL –∏–Ω–∂–µ–∫—Ü–∏—è –∫–æ–¥:

```csharp
string sqlQuery = "SELECT * FROM Users WHERE username = '"
+ user.Username
+ "' AND Password = '"
+ user.Password + "'";

var userExists = this.data.Users.FromSqlRaw(sqlQuery).Any();

if (userExists)
{
    // User found
}
else
{
    // User not found
}
```

–°—ä—â–∏—è—Ç –∫–æ–¥, –ø—Ä–µ–Ω–∞–ø–∏—Å–∞–Ω –ø—Ä–∞–≤–∏–ª–Ω–æ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞–Ω–∞ –∑–∞—è–≤–∫–∞:

```csharp
var userExists = this.data.Users
    .Any(u => u.Username == user.Username && u.Password == user.Password);

if (userExists)
{
    // User found
}
else
{
    // User not found
}
```

–ü—Ä–µ–¥–ø–∞–∑–≤–∞–Ω–µ –æ—Ç SQL –∏–Ω–∂–µ–∫—Ü–∏–∏ ‚Äì –ø—Ä–∏–º–µ—Ä–µ–Ω –∫–æ–¥.
#### Parameterized Queries
**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ –∑–∞—è–≤–∫–∏—Ç–µ –µ –¥–æ—Å—Ç–∞—Ç—ä—á–Ω–∞ –º—è—Ä–∫–∞ –∑–∞ –∑–∞—â–∏—Ç–∞ —Å—Ä–µ—â—É SQL –∏–Ω–∂–µ–∫—Ü–∏–∏**, —Ç—ä–π –∫–∞—Ç–æ ORM-—ä—Ç –≤–∞–ª–∏–¥–∏—Ä–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–≤–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ. –í—Å–µ –ø–∞–∫, –æ—Ç –≤—Ä–µ–º–µ –Ω–∞ –≤—Ä–µ–º–µ —Å–µ –ø–æ—è–≤—è–≤–∞—Ç –¥–æ–∫–ª–∞–¥–∏ –∑–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏, –ø—Ä–∏ –∫–æ–∏—Ç–æ –µ –±–∏–ª–∞ –ø—Ä–æ–ø—É—Å–Ω–∞—Ç–∞ –∏–Ω–∂–µ–∫—Ü–∏—è. –¢–æ–≤–∞ –º–æ–∂–µ –¥–∞ —Å–µ —Å–ª—É—á–∏, –∑–∞—Ç–æ–≤–∞ **–µ –ø—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–æ —Ä–µ–¥–æ–≤–Ω–æ –¥–∞ –æ–±–Ω–æ–≤—è–≤–∞–º–µ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–∏—Ç–µ –ø–∞–∫–µ—Ç–∏** –∏ –¥–∞ —Å–ª–µ–¥–∏–º –∑–∞ —Å–∏–≥–Ω–∞–ª–∏ –æ—Ç –¥–æ—Å—Ç–∞–≤—á–∏—Ü–∏—Ç–µ, –∫–∞—Ç–æ Microsoft, –∫–æ–≥–∞—Ç–æ –¥–∞–¥–µ–Ω –ø–∞–∫–µ—Ç –µ –º–∞—Ä–∫–∏—Ä–∞–Ω –∫–∞—Ç–æ —É—è–∑–≤–∏–º (vulnerable).
–í–∞–∂–Ω–æ —É—Ç–æ—á–Ω–µ–Ω–∏–µ –µ, —á–µ —Å—Ç—Ä–∏–Ω–≥–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ **`FormattableString`**, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ–±–∏–∫–Ω–æ–≤–µ–Ω **string**, –∑–∞ –¥–∞ –º–æ–∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞–Ω–µ—Ç–æ –¥–∞ –±—ä–¥–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏ –¥–∞ —Å–µ –≤—ä–∑–ø–æ–ª–∑–≤–∞ –æ—Ç –∑–∞—â–∏—Ç–∞—Ç–∞ —Å—Ä–µ—â—É –∏–Ω–∂–µ–∫—Ü–∏–∏. –ê–∫–æ –Ω–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ **`FormattableString`**, –∞ –ø—Ä–æ—Å—Ç–æ –æ–±–∏–∫–Ω–æ–≤–µ–Ω string, –∑–∞—è–≤–∫–∞—Ç–∞ —Å–µ –∏–∑–≥—Ä–∞–∂–¥–∞ –∫–∞—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–∞–Ω —Ç–µ–∫—Å—Ç –∏ —Å–µ –∏–∑–ø—Ä–∞—â–∞ –∫—ä–º SQL —Å—ä—Ä–≤—ä—Ä–∞ –∫–∞—Ç–æ –Ω–æ—Ä–º–∞–ª–Ω–∞ –∑–∞—è–≤–∫–∞ ‚Äî —Ç–æ–µ—Å—Ç –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –∫–æ–µ—Ç–æ —è –ø—Ä–∞–≤–∏ —É—è–∑–≤–∏–º–∞ –Ω–∞ SQL –∏–Ω–∂–µ–∫—Ü–∏–∏.

–ö–æ–≥–∞—Ç–æ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ **`FormattableString`**, ORM-—ä—Ç –∏–ª–∏ SQL –∫–ª–∏–µ–Ω—Ç–∞ —Ä–∞–∑–ø–æ–∑–Ω–∞–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ –≤ –∑–∞—è–≤–∫–∞—Ç–∞ –∏ –≥–∏ –∏–∑–ø—Ä–∞—â–∞ –æ—Ç–¥–µ–ª–Ω–æ –∫—ä–º SQL —Å—ä—Ä–≤—ä—Ä–∞ –∫–∞—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏. –¢–∞–∫–∞ —Å–∞–º–∞—Ç–∞ –∑–∞—è–≤–∫–∞ –≤ –±–∞–∑–∞—Ç–∞ –µ —Å—ä—Å —Å–∏–≥—É—Ä–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –∞ –Ω–µ —Å –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤–≥—Ä–∞–¥–µ–Ω–∏ –¥–∞–Ω–Ω–∏, –∫–æ–µ—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞ –∏–Ω–∂–µ–∫—Ü–∏–∏.

–° –¥—Ä—É–≥–∏ –¥—É–º–∏:

- –û–±–∏–∫–Ω–æ–≤–µ–Ω **string** ‚Üí –æ–ø–∞—Å–Ω–æ, –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤–º—ä–∫–≤–∞–Ω–µ –Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –≤ –∑–∞—è–≤–∫–∞—Ç–∞.
- **`FormattableString`** ‚Üí —Å–∏–≥—É—Ä–Ω–æ, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ —Å–µ –∏–∑–ø—Ä–∞—â–∞—Ç –æ—Ç–¥–µ–ª–Ω–æ –∏ —Å–µ —Ç—Ä–µ—Ç–∏—Ä–∞—Ç –∫–∞—Ç–æ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –∫–∞—Ç–æ —á–∞—Å—Ç –æ—Ç –∫–æ–¥–∞ –Ω–∞ –∑–∞—è–≤–∫–∞—Ç–∞.

–ò–º–µ–Ω–Ω–æ —Ç–æ–≤–∞ –ø—Ä–∞–≤–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞–Ω–µ—Ç–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –∑–∞—â–∏—Ç–∞ —Å—Ä–µ—â—É SQL –∏–Ω–∂–µ–∫—Ü–∏–∏.

**LINQ –∑–∞—è–≤–∫–∏—Ç–µ –≤ Entity Framework –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞–Ω–∏ SQL –∑–∞—è–≤–∫–∏** –∫—ä–º –±–∞–∑–∞—Ç–∞.

–ö–æ–≥–∞—Ç–æ –Ω–∞–ø–∏—à–µ–º –Ω–µ—â–æ –∫–∞—Ç–æ:

```csharp
var user = db.Users.FirstOrDefault(u => u.Username == inputUsername);
```

Entity Framework **–Ω–µ –≤–≥—Ä–∞–∂–¥–∞ –¥–∏—Ä–µ–∫—Ç–Ω–æ `inputUsername` –≤ SQL –∑–∞—è–≤–∫–∞—Ç–∞**, –∞ –≤–º–µ—Å—Ç–æ —Ç–æ–≤–∞ —Å—ä–∑–¥–∞–≤–∞ **–ø–∞—Ä–∞–º–µ—Ç—ä—Ä**:

```sql
SELECT TOP(1) * FROM Users WHERE Username = @__inputUsername_0
```

EF –ø–æ—Å–ª–µ –ø–æ–¥–∞–≤–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ `@__inputUsername_0` –∫–∞—Ç–æ –æ—Ç–¥–µ–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—ä—Ä.

–ú–æ–∂–µ —Ä—ä—á–Ω–æ –¥–∞ —Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞ –∑–∞—è–≤–∫–∞ –≤ Entity Framework —Å `SqlParameter` (–∏–ª–∏ `DbParameter`). –¢–æ–≤–∞ –≤–∞–∂–∏, –∫–æ–≥–∞—Ç–æ —Å–µ –ø–æ–ª–∑–≤–∞ `FromSqlRaw(...)`, –∫–æ–π—Ç–æ **–Ω–µ –µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –±–µ–∑–æ–ø–∞—Å–µ–Ω**, –∞–∫–æ —Å–µ –≤–∫–∞—Ä–≤–∞—Ç —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ —Å—Ç—Ä–∏–Ω–≥–∞.

```csharp
using Microsoft.Data.SqlClient; // For EF Core with SQL Server

string inputUsername = "Admin";

SqlParameter usernameParam = new SqlParameter("@username", inputUsername);

var users = db.Users
    .FromSqlRaw("SELECT * FROM Users WHERE Username = @username", usernameParam)
    .ToList();
```

–¢–æ–≤–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞ **–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–∞–Ω–∞ –∑–∞—è–≤–∫–∞** –∏ –µ –Ω–∞–ø—ä–ª–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ.
## Cross-Site Request Forgery
**Submit a Form on Behalf of Unsuspecting User**

```csharp
<!-- SOME MULTI-COLOR USELESS CLICKBAIT CONTENT -->

<form action="http://good-banking-site.com/api/account" method="post">
	<input type="hidden" name="Transaction" value="withdraw">
	<input type="hidden" name="Amount" value="1000000">
	<input type="submit" value="Click to collect your prize!">
</form>
```

Cross-Site Request Forgery (CSRF / XSRF) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–≤–∞ –∞—Ç–∞–∫–∞ —Å—Ä–µ—â—É —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –≤ —É–µ–± —Å—Ä–µ–¥–∞ —á—Ä–µ–∑ HTTP –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.

CSRF –µ –≤–∏–¥ —É—è–∑–≤–∏–º–æ—Å—Ç, –ø—Ä–∏ –∫–æ—è—Ç–æ –∞—Ç–∞–∫—É–≤–∞—â–∏—è—Ç —Å–µ –≤—ä–∑–ø–æ–ª–∑–≤–∞ –æ—Ç —Ñ–∞–∫—Ç–∞, —á–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –≤–µ—á–µ –µ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∏—Ä–∞ (–≤–ª—è–∑—ä–ª –≤ –∞–∫–∞—É–Ω—Ç–∞ —Å–∏) –≤ –Ω—è–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä —É–µ–±—Å–∞–π—Ç–∞ –Ω–∞ –±–∞–Ω–∫–∞.

–ë—Ä–∞—É–∑—ä—Ä—ä—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–ø—Ä–∞—â–∞ –≤—Å–∏—á–∫–∏ —Å–≤—ä—Ä–∑–∞–Ω–∏ **–±–∏—Å–∫–≤–∏—Ç–∫–∏** (cookies) —Å—ä—Å –∑–∞—è–≤–∫–∏—Ç–µ –∫—ä–º —Å–∞–π—Ç–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥–∞–ª–∏ –∑–∞—è–≤–∫–∞—Ç–∞ –∏–¥–≤–∞ –æ—Ç –∏—Å—Ç–∏–Ω—Å–∫–∏—è —Å–∞–π—Ç –∏–ª–∏ –æ—Ç –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω —Ç—Ä–µ—Ç–∏ —Å–∞–π—Ç.
### Demo
**Normal Workflow:**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ —Å—ä–≤—Å–µ–º –ø—Ä–æ—Å—Ç–æ.

–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ –º–æ–≥–∞—Ç –¥–∞ –≤–ª–∏–∑–∞—Ç –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –∏ –¥–∞ –ø—Ä–æ–º–µ–Ω—è—Ç —Å–≤–æ—è—Ç–∞ –ø–∞—Ä–æ–ª–∞.

–ù—è–º–∞ –∑–∞—â–∏—Ç–∞ —Å—Ä–µ—â—É CSRF.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –¥–æ—Å—Ç—ä–ø–Ω–æ –Ω–∞ –ø–æ—Ä—Ç 5001.

–í—Ö–æ–¥ —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞ —Å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ ‚Äûguest‚Äú –∏ –ø–∞—Ä–æ–ª–∞ ‚Äûguest123‚Äú.

–ü–∞—Ä–æ–ª–∞—Ç–∞ –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –ø—Ä–æ–º–µ–Ω–µ–Ω–∞.

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–∞ –ø—Ä–æ–º—è–Ω–∞ —Å–µ –ø–æ–∫–∞–∑–≤–∞ —Å—ä–æ–±—â–µ–Ω–∏–µ –∑–∞ —É—Å–ø–µ—Ö –Ω–∞ –Ω–∞—á–∞–ª–Ω–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞.

–°–ª–µ–¥ —Ç–æ–≤–∞ –º–æ–∂–µ –¥–∞ —Å–µ –≤–ª–µ–∑–µ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ —Å –Ω–æ–≤–∞—Ç–∞ –ø–∞—Ä–æ–ª–∞.

**Attack Workflow:**

–ü–æ—Å–µ—â–∞–≤–∞ —Å–µ –ª–∏–Ω–∫, –∫–æ–π—Ç–æ —Å–µ –Ω–∞–º–∏—Ä–∞ –Ω–∞ –Ω–∞—á–∞–ª–Ω–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞.

–¢–æ–π –≤–æ–¥–∏ –∫—ä–º –∑–ª–æ–≤—Ä–µ–¥–µ–Ω —Å–∞–π—Ç.

–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∞ [Click] —Å–µ –∑–∞–¥–µ–π—Å—Ç–≤–∞ –∞—Ç–∞–∫–∞—Ç–∞.

–ó–ª–æ–≤—Ä–µ–¥–Ω–æ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–º–µ–Ω—è –ø–∞—Ä–æ–ª–∞—Ç–∞ —á—Ä–µ–∑ CSRF.

–°–ª–µ–¥ —Ç–æ–≤–∞ –Ω–µ –µ –≤—ä–∑–º–æ–∂–Ω–æ –¥–∞ —Å–µ –≤–ª–µ–∑–µ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ —Å—ä—Å —Å—Ç–∞—Ä–∏—Ç–µ –¥–∞–Ω–Ω–∏ –∑–∞ –≤—Ö–æ–¥.

–ü–∞—Ä–æ–ª–∞—Ç–∞ –µ –ø—Ä–æ–º–µ–Ω–µ–Ω–∞ –Ω–∞ ‚Äûhacked!‚Äú.

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–µ–Ω –∫–æ–¥ –∏–º–∞ –≤ –¥–µ–º–æ –ø–∞–ø–∫–∞—Ç–∞.
### `AutoValidateAntiforgeryToken`
Tag Helper-—ä—Ç `<form>` –≤ ASP.NET Core –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–±–∞–≤—è —Å–ø–µ—Ü–∏–∞–ª–Ω–æ —Å–∫—Ä–∏—Ç–æ –ø–æ–ª–µ –∫—ä–º —Ñ–æ—Ä–º–∞—Ç–∞ –∑–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç CSRF. –ó–∞ –¥–∞ –±—ä–¥–µ —Ä–∞–∑–ø–æ–∑–Ω–∞—Ç –∫–∞—Ç–æ Tag Helper, –∞ –Ω–µ –∫–∞—Ç–æ –æ–±–∏–∫–Ω–æ–≤–µ–Ω HTML –µ–ª–µ–º–µ–Ω—Ç, —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –ø–æ–Ω–µ –µ–¥–∏–Ω –æ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏—Ç–µ `asp-` –∞—Ç—Ä–∏–±—É—Ç–∏. –í —Ç–∞–∫—ä–≤ —Å–ª—É—á–∞–π Visual Studio —â–µ –æ—Ü–≤–µ—Ç–∏ —Ç–∞–≥a –≤ –∑–µ–ª–µ–Ω–æ.

–¢–æ —Å—ä–¥—ä—Ä–∂–∞ –ø—Ä–æ–∏–∑–≤–æ–ª–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç, –Ω–∞—Ä–µ—á–µ–Ω–∞ anti-forgery token.

–°–ª–µ–¥ —Ç–æ–≤–∞ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ç–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç –¥–∞ —Å–µ –∏–∑–∏—Å–∫–≤–∞ –ø—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ –∑–∞—è–≤–∫–∞—Ç–∞.

–¢–æ–≤–∞ –º–æ–∂–µ –¥–∞ —Å–µ –ø—Ä–∏–ª–æ–∂–∏ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ. –ú–æ–∂–µ –¥–∞ —Å–µ –ø—Ä–∏–ª–æ–∂–∏ –∏ –∑–∞ –≤—Å–∏—á–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è –≤ –¥–∞–¥–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä. **–í–∞–ª–∏–¥–∞—Ü–∏—è—Ç–∞ –Ω–∞ –∞–Ω—Ç–∏-—Ñ–∞–ª—à–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–∏—è —Ç–æ–∫–µ–Ω —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –ø—Ä–µ–¥–∏–º–Ω–æ –ø—Ä–∏ POST –∑–∞—è–≤–∫–∏, –∫—ä–¥–µ—Ç–æ –∏–º–∞ —Ä–∏—Å–∫ –æ—Ç CSRF –∞—Ç–∞–∫–∏.**

```csharp
[AutoValidateAntiforgeryToken]
public IActionResult SendMoney(‚Ä¶) { ‚Ä¶ }

[AutoValidateAntiforgeryToken]
public class ManageController : Controller
```

–í—ä–∑–º–æ–∂–Ω–æ –µ –¥–∞ —Å–µ –ø—Ä–∏–ª–æ–∂–∏ –∏ –≥–ª–æ–±–∞–ª–Ω–æ –∑–∞ —Ü—è–ª–æ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

```csharp
services.AddMvc(options =>
    options.Filters.Add(new AutoValidateAntiforgeryTokenAttribute()));
```

Anti-forgery —Ç–æ–∫–µ–Ω—ä—Ç –µ **—É–Ω–∏–∫–∞–ª–µ–Ω –∑–∞ –≤—Å—è–∫–∞ —Å–µ—Å–∏—è** –∏ –ø–æ–Ω—è–∫–æ–≥–∞ –¥–æ—Ä–∏ –∑–∞ –≤—Å—è–∫–∞ —Ñ–æ—Ä–º–∞. –ö–æ–≥–∞—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –∑–∞—Ä–µ–¥–∏ –¥–∞–¥–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ñ–æ—Ä–º–∞, —Å—ä—Ä–≤—ä—Ä—ä—Ç:

1. **–ì–µ–Ω–µ—Ä–∏—Ä–∞ —Ç–æ–∫–µ–Ω** –∏ –≥–æ –∑–∞–ø–∏—Å–≤–∞ –Ω—è–∫—ä–¥–µ ‚Äì –æ–±–∏–∫–Ω–æ–≤–µ–Ω–æ –≤ —Å–µ—Å–∏—è, –∫—É–∫–∏ (cookie) –∏–ª–∏ –∫—Ä–∏–ø—Ç–∏—Ä–∞–Ω –º–µ—Ö–∞–Ω–∏–∑—ä–º.
    
2. **–í–≥—Ä–∞–∂–¥–∞ —Ç–æ–∫–µ–Ω–∞ –≤ HTML —Ñ–æ—Ä–º–∞—Ç–∞** –∫–∞—Ç–æ —Å–∫—Ä–∏—Ç–æ –ø–æ–ª–µ.
    
3. –ü—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∞, —Å—ä—Ä–≤—ä—Ä—ä—Ç:
    
    - –≤–∑–µ–º–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –æ—Ç —Å–∫—Ä–∏—Ç–æ—Ç–æ –ø–æ–ª–µ.
        
    - —Å—ä—â–æ —Ç–∞–∫–∞ –≤–∑–µ–º–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –æ—Ç —Å–µ—Å–∏—è—Ç–∞ –∏–ª–∏ –∫—É–∫–∏-—Ç–æ.
        
    - –∏ –ø—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ –¥–≤–µ—Ç–µ —Å—ä–≤–ø–∞–¥–∞—Ç.

–ê–∫–æ **–Ω–µ —Å—ä–≤–ø–∞–¥–∞—Ç**, —Ñ–æ—Ä–º–∞—Ç–∞ —Å–µ –æ—Ç—Ö–≤—ä—Ä–ª—è.

–ê—Ç–∞–∫—É–≤–∞—â–∏—è—Ç –Ω–µ –º–æ–∂–µ –ø—Ä–æ—Å—Ç–æ –¥–∞ –∫–æ–ø–∏—Ä–∞ —Ç–æ–∫–µ–Ω–∞, –∑–∞—â–æ—Ç–æ **–Ω—è–º–∞ –¥–æ—Å—Ç—ä–ø –¥–æ HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞ –∏ —Ç–æ–∫–µ–Ω–∞ –Ω–∞ –∂–µ—Ä—Ç–≤–∞—Ç–∞**. –ü—Ä–∏—á–∏–Ω–∞—Ç–∞ –µ:

- HTML —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ –∏ —Å–∫—Ä–∏—Ç–æ—Ç–æ –ø–æ–ª–µ —Å —Ç–æ–∫–µ–Ω–∞ —Å–µ –∏–∑–ø—Ä–∞—â–∞—Ç –∫—ä–º –±—Ä–∞—É–∑—ä—Ä–∞ –Ω–∞ –∂–µ—Ä—Ç–≤–∞—Ç–∞.
    
- –ó–∞—Ä–∞–¥–∏ **Same-Origin Policy** –∑–ª–æ–≤—Ä–µ–¥–Ω–∏—è—Ç —Å–∞–π—Ç **–Ω–µ –º–æ–∂–µ –¥–∞ —á–µ—Ç–µ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∏—Ç–µ, –∑–∞—Ä–µ–¥–µ–Ω–∏ –æ—Ç –¥—Ä—É–≥ –¥–æ–º–µ–π–Ω (–≤ —Å–ª—É—á–∞—è ‚Äì –æ—Ç –±–∞–Ω–∫–∞—Ç–∞).
    
- –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ, –¥–æ—Ä–∏ –∏ –¥–∞ —Å—ä–∑–¥–∞–¥–µ —Ñ–∞–ª—à–∏–≤–∞ —Ñ–æ—Ä–º–∞, **–∞—Ç–∞–∫—É–≤–∞—â–∏—è—Ç –Ω–µ –∑–Ω–∞–µ –≤–∞–ª–∏–¥–Ω–∏—è —Ç–æ–∫–µ–Ω** –Ω–∞ –∂–µ—Ä—Ç–≤–∞—Ç–∞ –∏ –Ω–µ –º–æ–∂–µ –¥–∞ –≥–æ –≤–º—ä–∫–Ω–µ.

–ê–Ω—Ç–∏-—Ñ–∞–ª—à–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–∏—è—Ç —Ç–æ–∫–µ–Ω –≤ ASP.NET Core **–∑–∞–≤–∏—Å–∏ –æ—Ç Data Protection –∫–ª—é—á–æ–≤–µ**, –∫–æ–∏—Ç–æ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è. –ê–∫–æ –∫–ª—é—á–æ–≤–µ—Ç–µ **–ª–∏–ø—Å–≤–∞—Ç** –∏–ª–∏ **–Ω–µ —Å–∞ –¥–æ—Å—Ç—ä–ø–Ω–∏** (–Ω–∞–ø—Ä. –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ, –ª–∏–ø—Å–∞ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–ª–∏ –≤ production —Å—Ä–µ–¥–∞ –±–µ–∑ –ø–µ—Ä—Å–∏—Å—Ç–∏—Ä–∞–Ω–µ), —Ç–æ–∫–µ–Ω—ä—Ç –Ω—è–º–∞ –¥–∞ –º–æ–∂–µ –¥–∞ —Å–µ –≤–∞–ª–∏–¥–∏—Ä–∞.

–ü–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ –≤ development —Ä–µ–∂–∏–º –∫–ª—é—á–æ–≤–µ—Ç–µ —Å–µ –ø–∞–∑—è—Ç –ª–æ–∫–∞–ª–Ω–æ, –Ω–æ –≤ production —Ç—Ä—è–±–≤–∞ **–∏–∑—Ä–∏—á–Ω–æ –¥–∞ —Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞** –º—è—Å—Ç–æ –∑–∞ —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–∞–ø–∫–∞, –±–∞–∑–∞, Azure –∏–ª–∏ Redis.
### Protective measures
–ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ anti-forgery —Ç–æ–∫–µ–Ω.

–î–æ–±–∞–≤—è —Å–µ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è –ø—Ä–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—è.

–ó–∞–¥–∞–≤–∞ —Å–µ —Ñ–ª–∞–≥—ä—Ç `SameSite` –∑–∞ –±–∏—Å–∫–≤–∏—Ç–∫–∏—Ç–µ.

```
Set-Cookie: CookieName=CookieValue; SameSite=Strict;
```

–°–ª–µ–¥–≤–∞ —Å–µ RESTful –ø–æ–¥—Ö–æ–¥ –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ.

–ê–∫—Ç–∏–≤–∏—Ä–∞ —Å–µ –∑–∞—â–∏—Ç–∞ —á—Ä–µ–∑ CORS.

**–ü—Ä–∏–º–µ—Ä–µ–Ω —Å—Ü–µ–Ω–∞—Ä–∏–π —Å –±–∞–Ω–∫–∞:**

1. –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç —Å–µ –ª–æ–≥–≤–∞ –≤ –∏—Å—Ç–∏–Ω—Å–∫–∏—è —Å–∞–π—Ç –Ω–∞ –±–∞–Ω–∫–∞—Ç–∞ ‚Äî `bank.com`. –ë—Ä–∞—É–∑—ä—Ä—ä—Ç —Å—ä—Ö—Ä–∞–Ω—è–≤–∞ **—Å–µ—Å–∏–π–Ω–∞—Ç–∞ –±–∏—Å–∫–≤–∏—Ç–∫–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä `sessionid=abc123`).
    
2. –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –µ –æ—Å—Ç–∞–≤–∏–ª —Å–µ—Å–∏—è—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞ (–Ω–µ —Å–µ –µ —Ä–∞–∑–ª–æ–≥–Ω–∞–ª) –∏ –º–µ–∂–¥—É–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ—Å–µ—â–∞–≤–∞ —Ñ–∞–ª—à–∏–≤ —Å–∞–π—Ç ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä `freemoney.com`, –∫–æ–π—Ç–æ –ø—Ä–∏–ª–∏—á–∞ –Ω–∞ –±–∞–Ω–∫–∞—Ç–∞, –Ω–æ –Ω–µ –µ —Ä–µ–∞–ª–Ω–∏—è—Ç —Å–∞–π—Ç.
    
3. –í —Ç–æ–∑–∏ —Ñ–∞–ª—à–∏–≤ —Å–∞–π—Ç –µ –≤–≥—Ä–∞–¥–µ–Ω —Å–∫—Ä–∏—Ç HTML –∫–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```csharp
<form action="https://bank.com/transfer" method="POST">
    <input type="hidden" name="toAccount" value="HACKER_ACCOUNT" />
    <input type="hidden" name="amount" value="1000" />
    <input type="submit" value="Click here to claim your prize!" />
</form>
```

4. –ê–∫–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –∫–ª–∏–∫–Ω–µ –±—É—Ç–æ–Ω–∞ (–∏–ª–∏ –∞–∫–æ —Ñ–æ—Ä–º–∞—Ç–∞ —Å–µ –∏–∑–ø—Ä–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á—Ä–µ–∑ JavaScript), –±—Ä–∞—É–∑—ä—Ä—ä—Ç —â–µ –Ω–∞–ø—Ä–∞–≤–∏ —Ä–µ–∞–ª–Ω–∞ –∑–∞—è–≤–∫–∞ –∫—ä–º `bank.com`, –∫–∞—Ç–æ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–ø—Ä–∞—Ç–∏ –∏ —Å–µ—Å–∏–π–Ω–∞—Ç–∞ –±–∏—Å–∫–≤–∏—Ç–∫–∞** (–∑–∞—â–æ—Ç–æ —Å–∞–π—Ç—ä—Ç –µ –¥–æ–≤–µ—Ä–µ–Ω –∏ –≤–µ—á–µ –µ –æ—Ç–≤–æ—Ä–µ–Ω).
    
5. –ê–∫–æ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –Ω–∞ –±–∞–Ω–∫–∞—Ç–∞ –Ω—è–º–∞ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ (–∫–∞—Ç–æ **CSRF —Ç–æ–∫–µ–Ω**, –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ), —Ç–æ–≥–∞–≤–∞ –∑–∞—è–≤–∫–∞—Ç–∞ —â–µ –±—ä–¥–µ –ø—Ä–∏–µ—Ç–∞ –∫–∞—Ç–æ –ª–µ–≥–∏—Ç–∏–º–Ω–∞ –∏ –ø–∞—Ä–∏—Ç–µ —â–µ –±—ä–¥–∞—Ç –ø—Ä–µ–≤–µ–¥–µ–Ω–∏ –∫—ä–º —Å–º–µ—Ç–∫–∞—Ç–∞ –Ω–∞ –∞—Ç–∞–∫—É–≤–∞—â–∏—è.

–ë–∞–Ω–∫–∞—Ç–∞ "–º–∏—Å–ª–∏", —á–µ —Ç–∞–∑–∏ –∑–∞—è–≤–∫–∞ –µ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∞ –¥–æ–±—Ä–æ–≤–æ–ª–Ω–æ –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è, –∑–∞—â–æ—Ç–æ –∏–∑–≥–ª–µ–∂–¥–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ –Ω–∞ –Ω–æ—Ä–º–∞–ª–Ω–∞ –∑–∞—è–≤–∫–∞ –∏ –∏–¥–≤–∞ —Å—ä—Å —Å—ä–æ—Ç–≤–µ—Ç–Ω–∞—Ç–∞ –±–∏—Å–∫–≤–∏—Ç–∫–∞.

**–ö–∞–∫ —Å–µ –∑–∞—â–∏—Ç–∞–≤–∞?**

- –ß—Ä–µ–∑ **CSRF —Ç–æ–∫–µ–Ω–∏** ‚Äì —É–Ω–∏–∫–∞–ª–Ω–∏ —Å–∫—Ä–∏—Ç–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, –∫–æ–∏—Ç–æ —Å–µ –≤–∫–ª—é—á–≤–∞—Ç –≤—ä–≤ –≤—Å—è–∫–∞ —Ñ–æ—Ä–º–∞ –∏ –∫–æ–∏—Ç–æ –Ω–µ –º–æ–≥–∞—Ç –¥–∞ –±—ä–¥–∞—Ç –ø–æ–∑–Ω–∞—Ç–∏ –æ—Ç –≤—ä–Ω—à–µ–Ω —Å–∞–π—Ç.
    
- –ß—Ä–µ–∑ **–¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–æ –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ** ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä –∏–∑—Å–∫–∞—á–∞—â –ø—Ä–æ–∑–æ—Ä–µ—Ü "–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –ø—Ä–µ–≤–µ–¥–µ—Ç–µ X –ª–≤. –∫—ä–º Y?"
    
- –ß—Ä–µ–∑ **–Ω–µ —Å–µ —Ä–∞–∑—á–∏—Ç–∞ —Å–∞–º–æ –Ω–∞ cookies –∑–∞ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è**, –∞ –∫–æ–º–±–∏–Ω–∏—Ä–∞–Ω–µ —Å –¥—Ä—É–≥–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∏ –∫–∞—Ç–æ headers, –∫–æ–∏—Ç–æ –≤—ä–Ω—à–µ–Ω —Å–∞–π—Ç –Ω–µ –º–æ–∂–µ –¥–∞ –∏–∑–ø—Ä–∞—Ç–∏.
## Parameter Tampering
**Changing Input Parameters at the Client Side**

Parameter Tampering –µ –º–∞–Ω–∏–ø—É–ª–∞—Ü–∏—è –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ, –∫–æ–∏—Ç–æ —Å–µ –æ–±–º–µ–Ω—è—Ç –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç –∏ —Å—ä—Ä–≤—ä—Ä.

–ü—Ä–æ–º–µ–Ω—è—Ç —Å–µ query strings, request bodies –∏–ª–∏ –±–∏—Å–∫–≤–∏—Ç–∫–∏.

–ü—Ä–æ–ø—É—Å–∫–∞—Ç —Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –∏–ª–∏ —Å–µ –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞—Ç –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏.
### Demo
–ò–º–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ–µ—Ç–æ –ø–æ–∫–∞–∑–≤–∞ –¥–∞–Ω–Ω–∏ –ø–æ ID.

–ù–µ —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–∞–≤–∞—Ç–∞ –∑–∞ –¥–æ—Å—Ç—ä–ø.

–•–∞–∫–µ—Ä –º–æ–∂–µ –¥–∞ —Å–º–µ–Ω–∏ ID-—Ç–æ –Ω–∞ –ø—Ä–µ–≥–ª–µ–¥–∞ –≤ URL –∞–¥—Ä–µ—Å–∞.

–¢–∞–∫–∞ –ø–æ–ª—É—á–∞–≤–∞ –¥–æ—Å—Ç—ä–ø –¥–æ –¥–∞–Ω–Ω–∏ –Ω–∞ –¥—Ä—É–≥–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏.

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–µ–Ω –∫–æ–¥ –∏–º–∞ –≤ –¥–µ–º–æ –ø–∞–ø–∫–∞—Ç–∞.
### Protective measures
–ü—Ä–æ–≤–µ—Ä—è–≤–∞—Ç —Å–µ –≤—Ö–æ–¥–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø—Ä–µ–¥–∏ –¥–æ—Å—Ç—ä–ø –¥–æ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏.

–§–æ—Ä–º–∏—Ç–µ –≤ —Å–∞–π—Ç–∞ —Å—ä–¥—ä—Ä–∂–∞—Ç –≤–≥—Ä–∞–¥–µ–Ω–∞ –∑–∞—â–∏—Ç–∞.

–ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ —Ä–µ–≥—É–ª—è—Ä–Ω–∏ –∏–∑—Ä–∞–∑–∏ (regex) –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –∏–ª–∏ –≤–∞–ª–∏–¥–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏.

–ò–∑–±—è–≥–≤–∞ —Å–µ –Ω–µ–∂–µ–ª–∞–Ω–∞ –∏–ª–∏ —Å–∫—Ä–∏—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

–ö—Ä–∏–ø—Ç–∏—Ä–∞—Ç —Å–µ –±–∏—Å–∫–≤–∏—Ç–∫–∏—Ç–µ –∑–∞ —Å–µ—Å–∏—è—Ç–∞.

–ï–¥–Ω–∞ –æ—Ç –Ω–∞–π-–≤–∞–∂–Ω–∏—Ç–µ –∑–∞—â–∏—Ç–∏ —Å—Ä–µ—â—É **parameter tampering** –µ –¥–∞ —Å–µ –ø—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—è—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –∏–º–∞ –ø—Ä–∞–≤–æ –¥–∞ –¥–æ—Å—Ç—ä–ø–≤–∞ –∏–ª–∏ –ø—Ä–æ–º–µ–Ω—è —Ä–µ—Å—É—Ä—Å–∞**, –∑–∞ –∫–æ–π—Ç–æ –µ –ø–æ–¥–∞–¥–µ–Ω–∞ –∑–∞—è–≤–∫–∞—Ç–∞.

**–ü–æ-–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ, –ø—Ä–µ–¥–ø–∞–∑–≤–∞–Ω–µ—Ç–æ –≤–∫–ª—é—á–≤–∞:**

–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ **–∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—Ç–∞** ‚Äì –∫–æ–π –µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç, –Ω–∞–ø—Ä–∞–≤–∏–ª –∑–∞—è–≤–∫–∞—Ç–∞ (—á—Ä–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è).

–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ **–ø—Ä–∞–≤–∞—Ç–∞ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)** ‚Äì –∏–º–∞ –ª–∏ —Ç–æ–∑–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –¥–æ—Å—Ç—ä–ø –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—è —Ä–µ—Å—É—Ä—Å (–Ω–∞–ø—Ä. —á—É–∂–¥–æ ID –≤ URL: `/Order/1234`).

–ù–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ —Ä–∞–∑—á–∏—Ç–∞ —Å–∞–º–æ –Ω–∞ —Å–∫—Ä–∏—Ç–∏ –ø–æ–ª–µ—Ç–∞ –∏–ª–∏ frontend –ª–æ–≥–∏–∫–∞ ‚Äì attacker-—ä—Ç –º–æ–∂–µ –¥–∞ –≥–∏ –ø—Ä–æ–º–µ–Ω–∏.

**–ü—Ä–∏–º–µ—Ä:**

–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª A –≤–∏–∂–¥–∞ URL –∫–∞—Ç–æ:

```
GET /Invoices/1001
```

–∏ —Ä–µ—à–∞–≤–∞ –¥–∞ —Å–º–µ–Ω–∏ –Ω–∞:

```
GET /Invoices/1002
```

–ë–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç —Å—Ç—Ä–∞–Ω–∞ –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞, —Ç–æ–≤–∞ –º–æ–∂–µ –¥–∞ –¥–∞–¥–µ –¥–æ—Å—Ç—ä–ø –¥–æ —á—É–∂–¥–∞ —Ñ–∞–∫—Ç—É—Ä–∞.

–†–µ—à–µ–Ω–∏–µ—Ç–æ –µ:

```csharp
if (invoice.UserId != currentUser.Id)
{
    return Forbid();
}
```

**–û–±–æ–±—â–µ–Ω–∏–µ:**

–ó–∞ –¥–∞ —Å–µ –∑–∞—â–∏—Ç–∏–º –æ—Ç parameter tampering, —Ç—Ä—è–±–≤–∞ **–≤–∏–Ω–∞–≥–∏ –¥–∞ —Å–µ –ø—Ä–∞–≤–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ —Ç–µ–∫—É—â–∏—è—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –∏–º–∞ –ø—Ä–∞–≤–æ –¥–∞ –¥–æ—Å—Ç—ä–ø–∏ –∏–ª–∏ –ø—Ä–æ–º–µ–Ω–∏ –¥–∞–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å**, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –∫–∞–∫—ä–≤ –ø–∞—Ä–∞–º–µ—Ç—ä—Ä –µ –ø–æ–¥–∞–¥–µ–Ω –≤ –∑–∞—è–≤–∫–∞—Ç–∞.
## Cross Origin Resource Sharing (CORS)
–°–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –≤ –±—Ä–∞—É–∑—ä—Ä–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞ —É–µ–± —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–∞ –∏–∑–ø—Ä–∞—â–∞ –∑–∞—è–≤–∫–∏ –∫—ä–º –¥–æ–º–µ–π–Ω, —Ä–∞–∑–ª–∏—á–µ–Ω –æ—Ç —Ç–æ–∑–∏, –∫–æ–π—Ç–æ —è –µ –∑–∞—Ä–µ–¥–∏–ª (–Ω–µ–π–Ω–∏—è origin).

–¢–æ–≤–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–µ –Ω–∞—Ä–∏—á–∞ Same-Origin Policy (SOP).

–¢–∞–∑–∏ –ø–æ–ª–∏—Ç–∏–∫–∞ —Å—ä—â–æ —Ç–∞–∫–∞ –ø—Ä–µ—á–∏ –Ω–∞ –∑–ª–æ–≤—Ä–µ–¥–Ω–∏ —Å–∞–π—Ç–æ–≤–µ –¥–∞ —á–µ—Ç–∞—Ç –¥–∞–Ω–Ω–∏ –æ—Ç –Ω–∞—à–∏—è —Å–∞–π—Ç.

–ü–æ–Ω—è–∫–æ–≥–∞ –æ–±–∞—á–µ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–∞ —Å–µ –ø–æ–∑–≤–æ–ª–∏ –Ω–∞ –¥—Ä—É–≥–∏ —Å–∞–π—Ç–æ–≤–µ –¥–∞ –∑–∞–æ–±–∏–∫–æ–ª—è—Ç —Ç–æ–≤–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ.

–ö—Ä–æ—Å-–¥–æ–º–µ–π–Ω –∑–∞—è–≤–∫–∏—Ç–µ –∫—ä–º –Ω–∞—à–µ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ –¥–∞ —Å—Ç–∞–Ω–∞—Ç –Ω—É–∂–Ω–∏ –≤ –¥–∞–¥–µ–Ω –º–æ–º–µ–Ω—Ç.

–¢—É–∫ –∏–¥–≤–∞ –Ω–∞ –ø–æ–º–æ—â Cross Origin Resource Sharing (CORS).

–¢–∞–∑–∏ –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –≤ –±—Ä–∞—É–∑—ä—Ä–∏, –∫–æ–∏—Ç–æ —Å–ø–∞–∑–≤–∞—Ç Same-Origin Policy.

–ê–∫–æ –Ω—è–∫–æ–π –∏–∑–ø–æ–ª–∑–≤–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∫–∞—Ç–æ Postman –∏–ª–∏ –¥—Ä—É–≥ –∫–ª–∏–µ–Ω—Ç –∑–∞ –¥–∏—Ä–µ–∫—Ç–Ω–∏ HTTP –∑–∞—è–≤–∫–∏, —Ç–µ–∑–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–µ –≤–∞–∂–∞—Ç.

–ó–∞—Ç–æ–≤–∞ –µ –≤–∞–∂–Ω–æ –¥–∞ —Å–µ –ø—Ä–∏–ª–∞–≥–∞—Ç –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ —Å—ä—Ä–≤—ä—Ä–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è, –∑–∞ –¥–∞ —Å–µ –ø—Ä–µ–¥–ø–∞–∑–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –æ—Ç –Ω–µ–∂–µ–ª–∞–Ω–∏ –∑–∞—è–≤–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞.

CORS –µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –Ω–∞ W3C, –∫–æ–π—Ç–æ –ø–æ–∑–≤–æ–ª—è–≤–∞ –Ω–∞ —Å—ä—Ä–≤—ä—Ä –¥–∞ ‚Äû–æ—Ç–ø—É—Å–Ω–µ‚Äú –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ—Ç–æ –Ω–∞ Same-Origin Policy (SOP).

–° –ø–æ–º–æ—â—Ç–∞ –Ω–∞ CORS —Å—ä—Ä–≤—ä—Ä—ä—Ç –º–æ–∂–µ –∏–∑—Ä–∏—á–Ω–æ –¥–∞ —Ä–∞–∑—Ä–µ—à–∏ –Ω—è–∫–æ–∏ cross-origin –∑–∞—è–≤–∫–∏.

–¢–æ–≤–∞ –Ω–µ –æ–∑–Ω–∞—á–∞–≤–∞, —á–µ –≤—Å–∏—á–∫–∏ cross-origin –∑–∞—è–≤–∫–∏ —â–µ –±—ä–¥–∞—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏.

–î–≤–∞ URL –∞–¥—Ä–µ—Å–∞ –∏–º–∞—Ç –µ–¥–Ω–∞–∫—ä–≤ origin, –∞–∫–æ –∏–º–∞—Ç

–µ–¥–Ω–∞–∫–≤–∏ scheme, host –∏ port (—Å–ø–æ—Ä–µ–¥ RFC 6454).

–ü—Ä–∏–º–µ—Ä–∏ –∑–∞ URL-—Ç–∞ —Å –µ–¥–∏–Ω –∏ —Å—ä—â–∏ origin:

[https://example.com/foo.html](https://example.com/foo.html)

[https://example.com/bar.html](https://example.com/bar.html)

–ü—Ä–∏–º–µ—Ä–∏ –∑–∞ —Ä–∞–∑–ª–∏—á–µ–Ω origin:

[https://example.net](https://example.net) ‚Äî —Ä–∞–∑–ª–∏—á–µ–Ω –¥–æ–º–µ–π–Ω.

[https://www.example.com/foo.html](https://www.example.com/foo.html) ‚Äî —Ä–∞–∑–ª–∏—á–µ–Ω —Å—É–±–¥–æ–º–µ–Ω.

[http://example.com/foo.html](http://example.com/foo.html) ‚Äî —Ä–∞–∑–ª–∏—á–µ–Ω scheme (http vs https).

[https://example.com:9000/foo.html](https://example.com:9000/foo.html) ‚Äî —Ä–∞–∑–ª–∏—á–µ–Ω –ø–æ—Ä—Ç.

**–ü—Ä–∏–º–µ—Ä –∑–∞ CORS**

–ü—Ä–µ–¥–∏ –¥–∞ –∏–∑–ø—Ä–∞—Ç–∏ –æ—Å–Ω–æ–≤–Ω–∞—Ç–∞ –∑–∞—è–≤–∫–∞, –∫–ª–∏–µ–Ω—Ç—ä—Ç –ø—Ä–∞–≤–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–∞ –∑–∞—è–≤–∫–∞ (preflight):

```
OPTIONS /resources HTTP/1.1
Host: api.example.com
Origin: example.com
Access-Control-Request-Method: DELETE
Access-Control-Request-Headers: Authorization
```

–¢–∞–∑–∏ preflight –∑–∞—è–≤–∫–∞ –ø—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ —Å—ä—Ä–≤—ä—Ä—ä—Ç —Ä–∞–∑—Ä–µ—à–∞–≤–∞ –º–µ—Ç–æ–¥–∞ DELETE –∏ –∑–∞–≥–ª–∞–≤–∏–µ—Ç–æ Authorization –∑–∞ cross-origin –∑–∞—è–≤–∫–∞ –æ—Ç example.com.

–°—ä—Ä–≤—ä—Ä—ä—Ç –æ—Ç–≥–æ–≤–∞—Ä—è —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏—Ç–µ Access-Control-Allow-* —Ö–µ–¥—ä—Ä–∏, –∫–æ–∏—Ç–æ –ø–æ–∫–∞–∑–≤–∞—Ç –∫–æ–∏ –º–µ—Ç–æ–¥–∏ –∏ —Ö–µ–¥—ä—Ä–∏ —Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏.

```
HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: DELETE
Access-Control-Allow-Headers: Authorization
```

–ê–∫–æ —Å—ä—Ä–≤—ä—Ä—ä—Ç –ø–æ—Ç–≤—ä—Ä–¥–∏, –∫–ª–∏–µ–Ω—Ç—ä—Ç –∏–∑–ø—Ä–∞—â–∞ —Ä–µ–∞–ª–Ω–∞—Ç–∞ DELETE –∑–∞—è–≤–∫–∞ —Å—ä—Å —Å—ä–æ—Ç–≤–µ—Ç–Ω–∏—è Authorization —Ö–µ–¥—ä—Ä.

```
DELETE /resources HTTP/1.1
Host: api.example.com
Origin: example.com
Authorization: Bearer‚Ä¶
```

–¢–∞–∫–∞ –±—Ä–∞—É–∑—ä—Ä—ä—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ cross-origin –∑–∞—è–≤–∫–∏—Ç–µ —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞—Ç —Å–∞–º–æ –∞–∫–æ —Å—ä—Ä–≤—ä—Ä—ä—Ç –µ –∏–∑—Ä–∏—á–Ω–æ —Ä–∞–∑—Ä–µ—à–∏–ª —Ç–æ–≤–∞.

**CORS –≤ ASP.NET Core —Å–µ –Ω–∞—Å—Ç—Ä–æ–π–≤–∞**

–ì–ª–æ–±–∞–ª–Ω–æ —á—Ä–µ–∑ middleware

–ó–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ (Action) –∏–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä —á—Ä–µ–∑ –∞—Ç—Ä–∏–±—É—Ç

–ü—Ä–∏–º–µ—Ä –∑–∞ –≥–ª–æ–±–∞–ª–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

```csharp
builder.Services.AddCors();

app.UseCors(builder =>
    builder.WithOrigins("http://example.com"));
```

–ü—Ä–∏–º–µ—Ä –∑–∞ —Ä–∞–∑—Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ CORS —Å–∞–º–æ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ:

```csharp
[HttpGet]
[EnableCors("AllowSpecificOrigin")]
public ContentResult GetTest()
{
    return Content("test");
}
```

–ü—Ä–∏–º–µ—Ä –∑–∞ –∏–∑–∫–ª—é—á–≤–∞–Ω–µ –Ω–∞ CORS –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ:

```csharp
[HttpGet]
[DisableCors]
public string Version()
{
    return "1.0.0";
}
```
# Misc
# ChatGPT
## `Html.Raw()`
In ASP.NET (particularly in Razor views), `Html.Raw()` is a method used to **output HTML markup without encoding it**. By default, Razor automatically HTML-encodes any content it outputs to protect against **cross-site scripting (XSS)**. However, sometimes you want to output HTML that **should not** be encoded ‚Äî that‚Äôs when `Html.Raw()` is useful.

**Example**

```csharp
@{
    var message = "<strong>Hello, world!</strong>";
}

@message         // Outputs: &lt;strong&gt;Hello, world!&lt;/strong&gt;
@Html.Raw(message)  // Outputs: <strong>Hello, world!</strong>
```

**When to Use `Html.Raw()`**

Use it **only when you are sure** that the content is safe and **doesn't come from untrusted sources**, because you're bypassing Razor‚Äôs automatic protection against XSS.

**Summary**

- `Html.Raw()` tells Razor to **skip encoding** the output.
    
- It is useful for **injecting raw HTML**.
    
- **Be careful**: if used improperly with user input, it can open the door to XSS attacks.
## Tag Helpers
In a Razor View in ASP.NET Core MVC, the **color coding** in Visual Studio (or Visual Studio Code with proper extensions) gives you visual feedback on what kind of tag you're working with:

- ‚úÖ **Green tags** (like `<form asp-action="..." method="post">` or `<input asp-for="..." />`) indicate you're using **Tag Helpers**. These are server-side components that generate HTML dynamically.
    
- üîµ **Blue tags** (like `<div>`, `<span>`, `<input type="text" />` without any `asp-` attributes) are just **standard HTML tags**, which will be rendered as-is on the client side.

**So to summarize:**

|Tag Type|Appearance|Meaning|
|---|---|---|
|Tag Helper|Green|Razor syntax with `asp-*`|
|Standard HTML Tag|Blue|Plain HTML, no Razor logic|
# Bookmarks
[OWASP Top Ten | OWASP Foundation](https://owasp.org/www-project-top-ten/) - –ò–Ω–¥—É—Å—Ç—Ä–∏–∞–ª–Ω–∏—è—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω —Å–ø–∏—Å—ä–∫ –Ω–∞ –¥–µ—Å–µ—Ç—Ç–µ –Ω–∞–π-–∫—Ä–∏—Ç–∏—á–Ω–∏ —Ä–∏—Å–∫–æ–≤–µ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ —É–µ–± –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ç–∞, –ø—É–±–ª–∏–∫—É–≤–∞–Ω –æ—Ç —Ñ–æ–Ω–¥–∞—Ü–∏—è—Ç–∞ OWASP. –°–ª—É–∂–∏ –∫–∞—Ç–æ –∫–ª—é—á–æ–≤–∞ —Ä–∞–º–∫–∞ –∑–∞ –Ω–∞—Å–æ—á–≤–∞–Ω–µ –∫—ä–º —Å–∏–≥—É—Ä–Ω–æ –∫–æ–¥–∏—Ä–∞–Ω–µ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∏ –¥–æ–±—Ä–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏.

[Exploit Database - Exploits for Penetration Testers, Researchers, and Ethical Hackers](https://www.exploit-db.com/) - –ü—É–±–ª–∏—á–µ–Ω –∞—Ä—Ö–∏–≤ –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ –µ–∫—Å–ø–ª–æ–π—Ç–∏.

[DotNet Security - OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/cheatsheets/DotNet_Security_Cheat_Sheet.html) - OWASP Cheat Sheet —Å –Ω–∞–π-–¥–æ–±—Ä–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç –≤ .NET

[Rick Strahl's Web Log](https://weblog.west-wind.com/) - –±–ª–æ–≥ —Å –ø–æ–ª–µ–∑–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

[mganss/HtmlSanitizer: Cleans HTML to avoid XSS attacks](https://github.com/mganss/HtmlSanitizer)

Completion: 29.05.2025